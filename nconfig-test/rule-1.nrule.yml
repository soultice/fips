- Rule:
    name: "Mock 1"
    when:
      matchesUris:
        - uri: ^/mock$
    then:
      functionAs: "Mock"
      body: 
        foo: "bar"
      status: "200" 
      headers:
        Content-Type: "application/json"
        X-Test: "test"

    with:
      plugins:
        - name: "foobar"
          path: './plugins/libtest_plugin.so'

- Rule:
    name: "FIPS 1"
    when:
      matchesUris:
        - uri: ^/fips$
    then:
      functionAs: "Fips"
      forwardUri: "http://localhost:8888/mock"
      modifyResponse: 
        keepHeaders:
          - "Content-Type"
        body:
          - at: "test"
            with: "baz"
          - at: "foobar"
            with: 
              - "new"
              - "array"
          - at: "plugin"
            with: "{{TestPlugin}}"

    with:
      plugins:
        - name: "foobar"
          path: './plugins/libtest_plugin.so'
   

- Rule:
    name: "Proxy"
    when:
      matchesUris:
        - uri: ^/proxy$
    then:
      functionAs: "Proxy"
      forwardUri: "http://localhost:8888/test"
  
  
